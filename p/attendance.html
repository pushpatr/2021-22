<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>#pushpaTr/2021-22/Attendance05</title>

	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link
		href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
		rel="stylesheet" />

	<style>
		* {
			box-sizing: border-box;
		}

		html {
			margin: 0;
			padding: 0;
			background: wheat;
		}

		body {
			margin-top: 30vh;
		}

		.flexCol {
			display: flex;
			flex-direction: column;
			width: 100%;
			height: auto;
			flex-grow: 1;
		}
		.noDisp{
			display: none;
		}
	</style>

</head>

<body>
	<div id="mainCont" class="flexCol">

		<form method="post" autocomplete="off" name="google-sheet" id="fifthAttnForm" onsubmit="return false">
			<input type="text" name="Name" class="form-control" placeholder="Your Name *" value="" required="" />
			<input type="text" name="Email" class="form-control" placeholder="Your Email *" value="" required="" />
			<input type="number" name="Phone" class="form-control" placeholder="Your Contact Number *" value="" required="" />
			<input type="text" class="noDisp" id="OSID" name="OS" value="" />
			<input type="text" class="noDisp" id="APPNAMEID" name="APPNAME" value="" />
			<input type="text" class="noDisp" id="APCDNAMEID" name="APCDNAME" value="" />
			<input type="text" class="noDisp" id="NAVIPLTFID" name="NAVIPLTF" value="" />
			<input type="text" class="noDisp" id="MAXPTSID" name="MAXPTS" value="" />
			<input type="submit" name="submit" class="btnSubmit btn-block" value="Submit Attendance" />
		</form>
	</div>


	<script src="https://code.jquery.com/jquery-3.6.0.min.js"
		integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

	<script type="text/javascript">

		$("#OSID").val(navigator.appVersion);
		$("#APPNAMEID").val(navigator.appName);
		$("#APCDNAMEID").val(navigator.appCodeName);
		$("#NAVIPLTFID").val(navigator.platform);
		$("#MAXPTSID").val(navigator.maxTouchPoints);

		const scriptURL = 'https://script.google.com/macros/s/AKfycbzB5z2ga6zUrOlVvB44DvMbY9zhVjB2GuvY4_dNzFQZPxKX4rrR4NdGPQ64G13zLdEHUg/exec'
		const form = document.forms['google-sheet'];

		$("#fifthAttnForm").submit(function (e) {
			e.preventDefault();
			$("body").html("Please wait, <br/>Class link will load in <div id='ctDn'></div> seconds!");
			fetch(scriptURL, { method: 'POST', body: new FormData(form) })
				.then(response => alert("Thanks!<br/>Your Attendance is submitted!!"))
				.catch(error => console.error('Error! Please try again or contact me on WhatsApp', error.message))

			let i = 6;
			setInterval(() => {
				i = i - 1;
				$("#ctDn").html(i);
			}, 1000);
			setTimeout(() => {
				window.location.replace("https://www.google.com/");
			}, 5000);
		});
	</script>
</body>

</html>